# 開発引継ぎ書: Vector Graphics Editor

## 📅 最終更新日: 2026-01-12
## 🚀 現在のフェーズ: Phase 4 (Layers & Style) - 完了

## ✅ 実装完了済み機能
1. **Core Architecture:**
   - React + Rust (Wasm) 構成。`rust-core/` ディレクトリを使用（`src-tauri` は禁止）。
   - コマンドパターンによるState管理。

2. **基本操作 (Interaction):**
   - 選択、移動、リサイズ、回転（逆行列による正確なヒットテスト実装済み）。
   - 回転しても座標系が壊れない堅牢なマトリックス演算。

3. **ペンツール (Path Engine):**
   - クリックで直線、ドラッグでベジェ曲線を描画可能。
   - **重要:** ドラッグ時の曲線生成ロジックは「Illustrator準拠（始点固定・終点カーブ）」に修正済み。この挙動を維持すること。

4. **スタイル編集:**
   - プロパティパネルでの「Fill/Stroke」変更機能。
   - カラーピッカー操作時の「リアルタイム再描画」対応済み。

5. **レイヤー管理 (Z-Index):** ✨ NEW
   - `bring_to_front()`: 選択オブジェクトを最前面に移動
   - `send_to_back()`: 選択オブジェクトを最背面に移動
   - プロパティパネルに「Layer Order」セクションを追加（⬆️ Front / ⬇️ Back ボタン）

## 🚧 次に取り組むタスク (Next Actions)
**Phase 4 は完了しました。** 次は以下の機能拡張を検討してください：

1. **レイヤーパネル (Tree View):**
   - ドキュメント構造をツリー表示
   - ドラッグ&ドロップによる順序変更
   - 可視性トグル、ロック機能

2. **グループ機能:**
   - 複数オブジェクトのグループ化/解除
   - グループ階層の管理

3. **Undo/Redo機能:**
   - コマンドパターンの活用
   - 履歴スタックの実装

## ⚠️ 技術的な注意点 (Constraints)
- **ディレクトリ構造:** Rustのコードは必ず `rust-core/` にある。
- **ペンツール:** `cp1` の計算ロジックにいらぬ "デバッグ用オフセット" を加えないこと（波線になってしまうため）。
- **再描画:** React側でRustの状態を変更した際は、必ず明示的な再描画トリガーを引くこと。
