cat << 'EOF' > HANDOVER.md
# 開発引継ぎ書: Vector Graphics Editor

## 📅 最終更新日: 2026-01-12
## 🚀 現在のフェーズ: Phase 4 (Layers & Style) - 進行中

## ✅ 実装完了済み機能
1. **Core Architecture:**
   - React + Rust (Wasm) 構成。`rust-core/` ディレクトリを使用（`src-tauri` は禁止）。
   - コマンドパターンによるState管理。

2. **基本操作 (Interaction):**
   - 選択、移動、リサイズ、回転（逆行列による正確なヒットテスト実装済み）。
   - 回転しても座標系が壊れない堅牢なマトリックス演算。

3. **ペンツール (Path Engine):**
   - クリックで直線、ドラッグでベジェ曲線を描画可能。
   - **重要:** ドラッグ時の曲線生成ロジックは「Illustrator準拠（始点固定・終点カーブ）」に修正済み。この挙動を維持すること。

4. **スタイル編集:**
   - プロパティパネルでの「Fill/Stroke」変更機能。
   - カラーピッカー操作時の「リアルタイム再描画」対応済み。

## 🚧 次に取り組むタスク (Next Actions)
現在は **Phase 4 の途中** です。スタイル編集が終わったので、次は **「レイヤー管理（重なり順）」** の実装が必要です。

### 次回の具体的な作業指示:
`specs/04_layers_style.md` の "3. Rust Core: Layer Order (Z-Index)" に着手してください。

1. **Rust側:**
   - `bring_to_front(id)` (最前面へ)
   - `send_to_back(id)` (最背面へ)
   - 上記コマンドを実装し、`Scene` 内の描画順序（Vecの並び順）を変更できるようにする。

2. **React側:**
   - プロパティパネル（またはレイヤーパネル）に、重なり順を変更するボタンを配置する。

## ⚠️ 技術的な注意点 (Constraints)
- **ディレクトリ構造:** Rustのコードは必ず `rust-core/` にある。
- **ペンツール:** `cp1` の計算ロジックにいらぬ "デバッグ用オフセット" を加えないこと（波線になってしまうため）。
- **再描画:** React側でRustの状態を変更した際は、必ず明示的な再描画トリガーを引くこと。
EOF

echo "✅ HANDOVER.md を作成しました。次回はこのファイルをAIに読ませてください。"